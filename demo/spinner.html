<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../summon-behavior.html">

<dom-module id="demo-spinner">
    <template>
        <style>
            :host {
                display: block;
            }
        </style>
        <div>Hi, I'm a spinner! {{ _spinCount }} elements are loading right now.</div>
    </template>
    <script>
    /* global Polymer, SummonBehavior */
    (function() {
        "use strict";

        Polymer({
            is: "demo-spinner",
            behaviors: [
                SummonBehavior
            ],
            properties: {
                _spinCount: {
                    type: Number,
                    value: 0,
                    observer: "_spinCountChanged"
                }
            },
            can: function(intent) {
                return intent == "loading-indicator";
            },
            summon: function() {
                this._spinCount++;
                var self = this;
                return (function() {
                    var stopped = false;

                    return function() {
                        if (!stopped) {
                            self._spinCount = Math.max(self._spinCount - 1, 0);
                            stopped = true;
                        }
                    };
                })();
            },
            _spinCountChanged: function() {
                this.style.display = this._spinCount ? "" : "none";
            }
        });

    })();
    </script>
</demo-spinner>
